/*!
 * Calendar v1.3.1 - Javascript Calendar plugin for Schedule Applications
 * Copyright 2022 Silvio Delgado (https://github.com/silviodelgado)
 * Licensed under MIT (https://opensource.org/licenses/MIT)
 * Dependencies: moment.js & Bootstrap 5+
 * https://github.com/silviodelgado/Calendar
*/
!function(e,t){"function"==typeof define&&define.amd?define([],t(e)):e.Calendar=t(e)}("undefined"!=typeof global?global:this.window||this.global,(function(e){"use strict";let t=moment(),d=0,a={};const n={container:"#calendar",dates:[],date:moment().date(1),language:"en",previousBtn:{text:"Prev",class:["btn-primary"]},nextBtn:{text:"Next",class:["btn-primary"]},todayBtn:{text:"Today",class:["btn-outline-primary"]}},o=function(e){return a=Object.assign(n,e),t.locale(a.language),a.date=t.date(1),m(),o},r=(e,t,d)=>{let a=t||[],n=d||[],o=document.createElement(e);return a.forEach(((e,t)=>{o.setAttribute(e[0],e[1])})),Array.isArray(n)?n.forEach(((e,t)=>{o.classList.add(e)})):"string"==typeof n&&o.classList.add(n),o},l=(e,t)=>{let d=new CustomEvent(e);t&&(d.data=t),document.querySelector(a.container).dispatchEvent(d)},i=e=>{let t=r("div",[["role","group"]],"btn-group"),d=r("button",[["type","button"]],["navigation","previous-month","btn","btn-sm"].concat(a.previousBtn.class));d.innerHTML=a.previousBtn.text,t.appendChild(d);let n=r("button",[["type","button"]],["navigation","today","btn","btn-sm"].concat(a.todayBtn.class));n.innerHTML=a.todayBtn.text,t.appendChild(n);let o=r("button",[["type","button"]],["navigation","next-month","btn","btn-sm"].concat(a.nextBtn.class));o.innerHTML=a.nextBtn.text,t.appendChild(o),e.appendChild(t)},c=e=>{let t=(()=>{let e=moment(a.date),t=[];for(var n=0;n<d;n++)for(var o=0;o<7;o++){let d=e.format("D");e.format("d")!=o?t.push(null):(t.includes(d)||t.push(d),d<=e.daysInMonth()&&e.add(1,"days"))}return t})(),n=document.createElement("tbody"),o=0,i=moment(a.date).subtract(1,"days");for(var c=0;c<d;c++){let e=document.createElement("tr");for(var s=0;s<7;s++){let d=document.createElement("td");if(t[o]){i.add(1,"days");let e=i.format("YYYY-MM-DD"),n=document.createElement("span");n.innerText=t[o],t[o]==moment().format("D")&&i.format("MM")==moment().format("MM")&&d.classList.add("today"),d.dataset.dt=e,d.appendChild(n),a.dates.filter((t=>t.date==e)).sort(((e,t)=>e.time<t.time?-1:e.time>t.time?1:0)).forEach(((e,t)=>{let a=(e.time?e.time+" - ":"")+e.title,n=r("div",[["title",a]],["event",e.type]),o=r("span"),i="<span>";e.done&&(i+='<b class="done">&check;</b>'),i+=a+"</span>",o.innerHTML=i,n.appendChild(o),n.addEventListener("click",(t=>(t.preventDefault(),l("calendar.date.select",{id:e.id,date:e.date,time:e.time}),!1))),d.append(n)}))}e.appendChild(d),o++}n.appendChild(e)}e.appendChild(n)},s=e=>{let t=document.createElement("table");t.classList.add("table","table-sm"),(e=>{let t=moment([2020,2,1]);t.locale(a.language);let d=r("thead"),n=document.createElement("tr"),o=document.createElement("th");o.innerText=t.format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),o.innerText=t.add(1,"days").format("dddd"),n.appendChild(o.cloneNode(!0)),d.appendChild(n),e.appendChild(d)})(t),d=(()=>{let e=moment(a.date).date(1),t=moment(e).date(e.daysInMonth()),d=1;for(1==t.week()&&d++;1==t.week();)t.add(-1,"days");return t.week()-e.week()+d})(),c(t),e.appendChild(t);let n=document.querySelector(".calendar .table").offsetWidth;Array.from(document.querySelectorAll(".calendar .table tbody td .event")).forEach(((e,t)=>{e.style.width=n/7-10+"px"}))},m=()=>{let e=document.querySelector(a.container);e.innerHTML="",e.classList.add("calendar"),(e=>{let t=r("div",null,["calendar-header","row"]),d=r("div",null,["col-sm-6","text-start"]),n=r("h3");n.innerHTML=a.date.format("MMMM YYYY"),d.appendChild(n),t.appendChild(d);let o=r("div",null,["col-sm-6","text-end"]);i(o),t.appendChild(o),e.appendChild(t)})(e),s(e),p()};o.next=()=>{a.date.add(-1,"month"),m(),l("calendar.month.change",a.date)},o.previous=()=>{a.date.add(1,"month"),m(),l("calendar.month.change",a.date)},o.today=()=>{a.date=moment().lang(a.language).date(1),m(),l("calendar.month.change")},o.current=()=>a.date,o.refresh=()=>{m(),l("calendar.refresh")},o.setDates=e=>{a.dates=e,m(),l("calendar.update")},o.remove=e=>{a.dates=a.dates.filter((t=>t.id!=e)),m(),l("calendar.update")},o.add=e=>{a.dates.push(e),m(),l("calendar.update")},o.done=e=>{a.dates.forEach(((t,d)=>{t.id==e&&(t.done=!0)})),m(),l("calendar.update")},o.undone=e=>{a.dates.forEach(((t,d)=>{t.id==e&&(t.done=!1)})),m(),l("calendar.update")};const p=()=>{document.querySelector(".calendar .navigation.previous-month").addEventListener("click",(e=>(e.preventDefault(),o.next(),!1))),document.querySelector(".calendar .navigation.next-month").addEventListener("click",(e=>(e.preventDefault(),o.previous(),!1))),document.querySelector(".calendar .navigation.today").addEventListener("click",(e=>(e.preventDefault(),o.today(),!1)))};return o}));